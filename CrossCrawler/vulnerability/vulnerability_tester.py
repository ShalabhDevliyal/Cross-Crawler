from selenium import webdriver
from selenium.webdriver.common.alert import Alert

class XSSVulnerabilityTester:
    def __init__(self):
        self.vulnerable_endpoints = []

    def test_endpoints(self, endpoints):
        for endpoint in endpoints:
            if self._is_vulnerable(endpoint):
                self.vulnerable_endpoints.append(endpoint)

    def _is_vulnerable(self, endpoint):
        # Initialize a headless browser
        options = webdriver.ChromeOptions()
        options.add_argument('--headless')
        driver = webdriver.Chrome(options=options)

        try:
            # Load the endpoint URL
            driver.get(endpoint)

            # Inject payload
            payload = "<script>alert('XSS')</script>"
            driver.execute_script(payload)

            # Check for alert presence (indicating XSS vulnerability)
            alert = Alert(driver)
            if alert.text == "XSS":
                return True
        except Exception as e:
            print(f"Error testing {endpoint}: {e}")
        finally:
            driver.quit()

        return False

    def get_vulnerable_endpoints(self):
        return self.vulnerable_endpoints
